# Leads Distributor Test Case


## Оглавление:
- [О проекте](#о-проекте)
- [Основные возможности](#основные-возможности)
- [Технологический стек](#технологический-стек)
- [Структура проекта](#структура-проекта)
- [API (основные эндпоинты)](#api-основные-эндпоинты)
- [Установка и запуск](#установка-и-запуск):
    - [Клонирование проекта](#клонирование-проекта)
    - [Запуск через Docker Compose](#запуск-через-docker-compose)
- [Тесты](#тесты)

## О проекте

CRM, предназначенная для распределения лидов между операторами по источникам.

**Цель проекта:** Автоматическое распределение лидов между операторами с учётом их показателей и настроек распределения.

## Основные возможности

- Управление операторами;
- Настройка распределения по источникам;
- Регистрация обращения;
- Просмотр состояния;
- Простое распределение по нагрузке (пока что реализовано через random).

## Технологический стек

**Язык:** Python 3.11+

**Web-фреймворк:** FastAPI

**ORM:** SQLAlchemy

**База данных:** SQLite

## Структура проекта
```
leads_distributor_test_case/
├── Dockerfile
├── README.md
├── docker-compose.yml
├── requirements.txt
├── app
│   ├── __init__.py
│   ├── crud.py
│   ├── database.py
│   ├── main.py
│   ├── models.py
│   └── schemas.py
└── tests
    ├── __init__.py
    ├── conftest.py
    ├── test_crud.py
    └── test_main.py

```

## API (основные эндпоинты)
- `POST /operators/` — создать оператора
- `GET /operators/` — список операторов
- `PATCH /operators/{id}` — изменить active/limit
- `POST /sources/` — создать источник
- `POST /sources/{source_id}/operators/` — назначить оператора на источник
- `POST /contacts/` — создать обращение
- `GET /leads/` — список лидов
- `GET /stats/` — основная статистика

## Установка и запуск

### Клонирование проекта

```bash
git clone https://[актуальный адрес проекта].git
cd leads_distributor_test_case
```

### Запуск через Docker Compose

```bash
docker-compose up --build
```

Проект запущен. Swagger UI доступен по эндпоинту **/docs**

## Тесты
Запуск тестов:
```bash
pytest -v
```
Запуск тестов с покрытием:
```bash
pytest --cov=. --cov-report=term-missing
```
